import random
import time
import numpy as np
import matplotlib.pyplot as plt
import comtypes
from comtypes.gen import STKUtil
from comtypes.gen import STKObjects
from comtypes.client import GetActiveObject
import cProfile, pstats, io

# 火焰图
pr = cProfile.Profile()
pr.enable()

# gobal parms
item_size = 500
gen = 200 - 26
cross_rate = 0.5
variation_rate = 0.4
totalTime = 27 * 24 * 60 * 60 + 7 * 60 * 60                 # 2358000
startTime = time.time()

print("---------------- begin STK init ----------------")
# init STK
uiApplication = GetActiveObject('STK10.Application')
uiApplication.Visible = False
root = uiApplication.Personality2
sc = root.CurrentScenario
sc2 = sc.QueryInterface(STKObjects.IAgScenario)

# 获取卫星
satTemp1 = sc.Children.Item('sat1')
sat1 = satTemp1.QueryInterface(STKObjects.IAgSatellite)
satTemp2 = sc.Children.Item('sat2')
sat2 = satTemp2.QueryInterface(STKObjects.IAgSatellite)

# 获取链路
chainTemp1 = sc.Children.Item("ChainChidao")
chain1 = chainTemp1.QueryInterface(STKObjects.IAgChain)
chainTemp2 = sc.Children.Item("ChainNanji")
chain2 = chainTemp2.QueryInterface(STKObjects.IAgChain)
chainTemp3 = sc.Children.Item("ChainYuebei")
chain3 = chainTemp3.QueryInterface(STKObjects.IAgChain)

# 获取卫星参数修改句柄
sat1.SetPropagatorType(STKObjects.ePropagatorJ4Perturbation)
J4Propagator1 = sat1.Propagator.QueryInterface(
    STKObjects.IAgVePropagatorJ4Perturbation)
keplerian1 = J4Propagator1.InitialState.Representation.ConvertTo(
    STKUtil.eOrbitStateClassical).QueryInterface(STKObjects.IAgOrbitStateClassical)
keplerian1.SizeShapeType = STKObjects.eSizeShapeSemimajorAxis
keplerian1.Orientation.AscNodeType = STKObjects.eAscNodeRAAN
keplerian1.LocationType = STKObjects.eLocationTrueAnomaly
sat2.SetPropagatorType(STKObjects.ePropagatorJ4Perturbation)
J4Propagator2 = sat2.Propagator.QueryInterface(
    STKObjects.IAgVePropagatorJ4Perturbation) 
keplerian2 = J4Propagator2.InitialState.Representation.ConvertTo(
    STKUtil.eOrbitStateClassical).QueryInterface(STKObjects.IAgOrbitStateClassical)
keplerian2.SizeShapeType = STKObjects.eSizeShapeSemimajorAxis
keplerian2.Orientation.AscNodeType = STKObjects.eAscNodeRAAN
keplerian2.LocationType = STKObjects.eLocationTrueAnomaly
print("---------------- finish STK init ----------------")


# def import_init_data():
#     data = []
#     fo = open("ga_good_init_data.txt", "r")
#     for line in fo:
#         line_data = line.split(" ")
#         line_data[-1] = line_data[-1][0 : -1]
#         line_data = list(map(float, line_data))
#         data.append(line_data[0 : 10])
#     fo.close()
#     np.random.shuffle(data) 
#     return data[0:item_size]


def modify(keplerian, a1, a2, a3, a4, a5, a6):
    # 半长轴长度
    keplerian.SizeShape.QueryInterface(STKObjects.IAgClassicalSizeShapeSemimajorAxis).SemiMajorAxis = a1
    # 偏心率
    keplerian.SizeShape.QueryInterface(STKObjects.IAgClassicalSizeShapeSemimajorAxis).Eccentricity = np.sqrt((1-5/3*np.cos(a3/180*np.pi)*np.cos(a3/180*np.pi)))
    # degrees 倾角
    keplerian.Orientation.Inclination = a3
    # degrees 近地点
    keplerian.Orientation.ArgOfPerigee = a4
    # RANN 设置轨道位置
    keplerian.Orientation.AscNode.QueryInterface(STKObjects.IAgOrientationAscNodeRAAN).Value = a5
    # 设置卫星在该轨道中的“相位”
    keplerian.Location.QueryInterface(STKObjects.IAgClassicalLocationTrueAnomaly).Value = a6


def cal(group, scores):
    # todo xzh
    for i in range(item_size):
        # 调整
        modify(keplerian1, 6500, 0, group[i][0], group[i][1], group[i][2], 0)
        sat1.Propagator.QueryInterface(
            STKObjects.IAgVePropagatorJ4Perturbation).InitialState.Representation.Assign(keplerian1)
        sat1.Propagator.QueryInterface(
            STKObjects.IAgVePropagatorJ4Perturbation).Propagate()
        modify(keplerian2, 6500, 0, group[i][3], group[i][4], group[i][5], group[i][6])
        sat2.Propagator.QueryInterface(
            STKObjects.IAgVePropagatorJ4Perturbation).InitialState.Representation.Assign(keplerian2)
        sat2.Propagator.QueryInterface(
            STKObjects.IAgVePropagatorJ4Perturbation).Propagate()

        # 计算
        chain1.ComputeAccess()
        chain2.ComputeAccess()
        chain3.ComputeAccess()
        chainResults1 = chainTemp1.DataProviders.GetDataPrvIntervalFromPath(
            "Complete Access").Exec(sc2.StartTime, sc2.StopTime)
        chainResults2 = chainTemp2.DataProviders.GetDataPrvIntervalFromPath(
            "Complete Access").Exec(sc2.StartTime, sc2.StopTime)
        chainResults3 = chainTemp3.DataProviders.GetDataPrvIntervalFromPath(
            "Complete Access").Exec(sc2.StartTime, sc2.StopTime)
        if chainResults1.DataSets.Count != 0:
            coverage1 = sum(chainResults1.DataSets.GetDataSetByName(
                "Duration").GetValues()) / totalTime * 100
        else:
            coverage1 = 0
        if chainResults2.DataSets.Count != 0:
            coverage2 = sum(chainResults2.DataSets.GetDataSetByName(
                "Duration").GetValues()) / totalTime * 100
        else:
            coverage2 = 0
        if chainResults3.DataSets.Count != 0:
            coverage3 = sum(chainResults3.DataSets.GetDataSetByName(
                "Duration").GetValues()) / totalTime * 100
        else:
            coverage3 = 0

        # 得分
        scores[i] = coverage1 + coverage2 + coverage3
    return scores

def cal_once(group):
    # 调整
    modify(keplerian1, 6500, 0, group[0], group[1], group[2], 0)
    sat1.Propagator.QueryInterface(
        STKObjects.IAgVePropagatorJ4Perturbation).InitialState.Representation.Assign(keplerian1)
    sat1.Propagator.QueryInterface(
        STKObjects.IAgVePropagatorJ4Perturbation).Propagate()
    modify(keplerian2, 6500, 0, group[3], group[4], group[5], group[6])
    sat2.Propagator.QueryInterface(
        STKObjects.IAgVePropagatorJ4Perturbation).InitialState.Representation.Assign(keplerian2)
    sat2.Propagator.QueryInterface(
        STKObjects.IAgVePropagatorJ4Perturbation).Propagate()

    # 计算
    chain1.ComputeAccess()
    chain2.ComputeAccess()
    chain3.ComputeAccess()
    chainResults1 = chainTemp1.DataProviders.GetDataPrvIntervalFromPath(
        "Complete Access").Exec(sc2.StartTime, sc2.StopTime)
    chainResults2 = chainTemp2.DataProviders.GetDataPrvIntervalFromPath(
        "Complete Access").Exec(sc2.StartTime, sc2.StopTime)
    chainResults3 = chainTemp3.DataProviders.GetDataPrvIntervalFromPath(
        "Complete Access").Exec(sc2.StartTime, sc2.StopTime)
    if chainResults1.DataSets.Count != 0:
        coverage1 = sum(chainResults1.DataSets.GetDataSetByName(
            "Duration").GetValues()) / totalTime * 100
    else:
        coverage1 = 0
    if chainResults2.DataSets.Count != 0:
        coverage2 = sum(chainResults2.DataSets.GetDataSetByName(
            "Duration").GetValues()) / totalTime * 100
    else:
        coverage2 = 0
    if chainResults3.DataSets.Count != 0:
        coverage3 = sum(chainResults3.DataSets.GetDataSetByName(
            "Duration").GetValues()) / totalTime * 100
    else:
        coverage3 = 0

    # 得分
    score = coverage1 + coverage2 + coverage3
    return score


def init():
    print("---------------- begin GA init ----------------")
    # input inited group
    group = [[52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [52.004359792233274, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 2.5239264026285912], [43.16383779843137, 90, 184.16159102114605, 43.53862133199943, 90, 131.19312946710414, 189.53880561764117], [51.54375895065756, 90, 256.6241398429291, 48.5724849114406, 90, 7.270692107687826, 129.6457157727014], [46.699834537330844, 90, 49.173812578275786, 48.6547931058651, 90, 140.72934241262493, 189.53880561764117], [52.004359792233274, 90, 17.809632929070716, 44.50466855109846, 90, 96.03518767730391, 178.10709001500345], [50.34928149245797, 90, 352.9660409595596, 51.16325026124113, 90, 347.31035907115137, 178.10709001500345], [52.04006385047204, 90, 184.16159102114605, 47.06065134055267, 90, 253.24635012026997, 159.70060580500873], [52.004359792233274, 90, 269.0755470746629, 49.366734541953235, 90, 281.56477646650535, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.315569125002696, 90, 258.332206048757, 133.34341212157588], [43.16383779843137, 90, 277.11632983416433, 48.353450317606026, 90, 339.3041705956085, 189.53880561764117], [43.16383779843137, 90, 216.07833240167224, 48.353450317606026, 90, 339.3041705956085, 157.9138877721893], [52.004359792233274, 90, 2.184307230365947, 49.34886557596016, 90, 119.55795142113953, 173.4902910479415], [52.04006385047204, 90, 327.17353915591923, 51.16325026124113, 90, 96.03518767730391, 174.49171904598907], [51.68949795508055, 90, 59.09673586497625, 47.36292688596339, 90, 96.03518767730391, 280.3371031562151], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 160.1864074493303], [52.004359792233274, 90, 277.11632983416433, 50.640982156834916, 90, 7.270692107687826, 151.86240231829092], [51.68949795508055, 90, 256.6241398429291, 39.44589413750743, 90, 96.03518767730391, 144.79165932836142], [50.51800344674469, 90, 17.809632929070716, 46.42082173768779, 90, 298.8163104632298, 219.28752426229048], [51.72874261354272, 90, 178.31499039017882, 51.70242571441147, 90, 347.31035907115137, 189.53880561764117], [51.26503502297843, 90, 207.06116785155479, 40.95539081238441, 90, 322.7099304072282, 189.53880561764117], [51.78608070553043, 90, 216.07833240167224, 50.35601017167101, 90, 96.03518767730391, 174.49171904598907], [46.699834537330844, 90, 2.184307230365947, 45.76623006809402, 90, 258.332206048757, 210.36453368432618], [52.004359792233274, 90, 216.07833240167224, 45.063045824345075, 90, 347.31035907115137, 178.10709001500345], [52.004359792233274, 90, 241.44986572925654, 51.16325026124113, 90, 339.3041705956085, 183.90409127690782], [51.54375895065756, 90, 17.809632929070716, 49.824298812571236, 90, 298.8163104632298, 148.58175466933884], [51.26503502297843, 90, 178.31499039017882, 46.11404496305942, 90, 347.31035907115137, 148.58175466933884], [51.72874261354272, 90, 277.11632983416433, 41.58406123327792, 90, 322.7099304072282, 357.04073962261384], [51.54375895065756, 90, 207.06116785155479, 40.95539081238441, 90, 251.1972914113363, 178.10709001500345], [51.655383417669334, 90, 269.0755470746629, 49.366734541953235, 90, 347.31035907115137, 159.70060580500873], [52.004359792233274, 90, 59.09673586497625, 46.56231715061847, 90, 238.8649847669475, 189.53880561764117], [52.004359792233274, 90, 216.07833240167224, 44.50843281051053, 90, 347.31035907115137, 178.10709001500345], [49.889055712118335, 90, 241.44986572925654, 49.34886557596016, 90, 347.31035907115137, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.07398948115247, 90, 301.8164954259951, 32.67518193579858], [47.83822743384326, 90, 2.184307230365947, 51.16325026124113, 90, 110.62505164266636, 157.9138877721893], [52.04006385047204, 90, 201.7059023602073, 49.315569125002696, 90, 258.332206048757, 183.90409127690782], [50.51800344674469, 90, 194.4975698920072, 44.89613657282584, 90, 347.31035907115137, 189.53880561764117], [43.16383779843137, 90, 277.11632983416433, 48.353450317606026, 90, 8.63496392244571, 189.53880561764117], [52.004359792233274, 90, 17.809632929070716, 44.50466855109846, 90, 96.03518767730391, 178.10709001500345], [52.004359792233274, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 294.09162187400847], [42.29558510098571, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 294.09162187400847], [52.004359792233274, 90, 255.3445764128222, 50.889662428248066, 90, 131.19312946710414, 189.53880561764117], [51.26503502297843, 90, 201.7059023602073, 51.16325026124113, 90, 140.72934241262493, 189.53880561764117], [51.655383417669334, 90, 2.184307230365947, 51.16325026124113, 90, 251.1972914113363, 350.0850767347009], [51.26503502297843, 90, 239.40004746654898, 50.10333280096795, 90, 301.8164954259951, 178.10709001500345], [50.51800344674469, 90, 194.4975698920072, 50.38676443481272, 90, 253.24635012026997, 174.49171904598907], [51.54375895065756, 90, 17.809632929070716, 40.54828604453396, 90, 298.8163104632298, 148.58175466933884], [52.004359792233274, 90, 184.16159102114605, 51.16325026124113, 90, 317.4261298105409, 170.39039894515142], [46.88530387207054, 90, 277.11632983416433, 48.48249190858248, 90, 298.8163104632298, 285.8498818322806], [48.060441279222275, 90, 2.184307230365947, 40.52284552769744, 90, 317.4261298105409, 183.6294621875325], [52.004359792233274, 90, 2.184307230365947, 49.34886557596016, 90, 258.332206048757, 173.4902910479415], [52.004359792233274, 90, 17.809632929070716, 41.394781108565596, 90, 110.62505164266636, 174.49171904598907], [52.004359792233274, 90, 17.809632929070716, 41.46443832524679, 90, 131.19312946710414, 144.79165932836142], [51.74726663344763, 90, 17.809632929070716, 42.792176262780345, 90, 347.31035907115137, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 51.16325026124113, 90, 251.1972914113363, 268.9663542542093], [52.004359792233274, 90, 184.16159102114605, 51.16325026124113, 90, 317.4261298105409, 170.39039894515142], [52.004359792233274, 90, 17.809632929070716, 42.792176262780345, 90, 347.31035907115137, 148.58175466933884], [52.004359792233274, 90, 178.31499039017882, 44.14092340969059, 90, 347.31035907115137, 189.53880561764117], [50.769633076686034, 90, 194.4975698920072, 51.16325026124113, 90, 347.31035907115137, 91.69829066809625], [51.74726663344763, 90, 277.11632983416433, 44.69557041931423, 90, 110.62505164266636, 174.49171904598907], [52.04006385047204, 90, 17.809632929070716, 41.394781108565596, 90, 110.62505164266636, 174.49171904598907], [52.004359792233274, 90, 184.16159102114605, 43.53862133199943, 90, 227.43391204709008, 64.73454937369296], [46.88530387207054, 90, 256.6241398429291, 50.10333280096795, 90, 110.62505164266636, 208.67143291963504], [52.004359792233274, 90, 327.17353915591923, 45.39235264368783, 90, 317.4261298105409, 189.53880561764117], [43.16383779843137, 90, 194.4975698920072, 47.809676423875565, 90, 339.3041705956085, 178.10709001500345], [52.004359792233274, 90, 17.809632929070716, 50.35601017167101, 90, 96.03518767730391, 174.49171904598907], [50.51800344674469, 90, 194.4975698920072, 43.53862133199943, 90, 96.03518767730391, 174.49171904598907], [49.889055712118335, 90, 184.16159102114605, 40.70609347699568, 90, 96.03518767730391, 279.7579091408357], [42.29558510098571, 90, 49.173812578275786, 44.004013253078945, 90, 131.19312946710414, 178.10709001500345], [46.699834537330844, 90, 17.809632929070716, 51.70242571441147, 90, 38.95166041297089, 178.10709001500345], [47.79673681903229, 90, 255.3445764128222, 44.004013253078945, 90, 143.1672368450601, 151.86240231829092], [52.004359792233274, 90, 323.5110467413477, 50.97980656044819, 90, 110.62505164266636, 146.03146260908062], [51.54375895065756, 90, 17.809632929070716, 49.824298812571236, 90, 298.8163104632298, 148.58175466933884], [51.655383417669334, 90, 277.11632983416433, 48.871703222824806, 90, 347.31035907115137, 178.10709001500345], [46.699834537330844, 90, 49.173812578275786, 51.16325026124113, 90, 96.03518767730391, 170.39039894515142], [51.74726663344763, 90, 2.184307230365947, 47.12874050608586, 90, 119.55795142113953, 69.16019125477494], [46.699834537330844, 90, 2.184307230365947, 45.76623006809402, 90, 347.31035907115137, 307.4213082274184], [51.78608070553043, 90, 273.62722827419014, 45.944864344406184, 90, 131.19312946710414, 239.3977164282495], [52.004359792233274, 90, 255.3445764128222, 44.882023390974396, 90, 110.62505164266636, 189.53880561764117], [46.88530387207054, 90, 17.809632929070716, 41.251630710118675, 90, 281.56477646650535, 157.9138877721893], [52.004359792233274, 90, 24.904064150366942, 50.06497042791354, 90, 251.1972914113363, 133.07454031232854], [46.110668261251696, 90, 273.62722827419014, 46.65356364138034, 90, 131.19312946710414, 14.157530606790484], [51.54375895065756, 90, 194.4975698920072, 50.06497042791354, 90, 347.31035907115137, 157.9138877721893], [51.74726663344763, 90, 2.184307230365947, 49.34886557596016, 90, 119.55795142113953, 178.10709001500345], [50.769633076686034, 90, 49.173812578275786, 50.012321636009716, 90, 110.62505164266636, 157.9138877721893], [46.88530387207054, 90, 17.809632929070716, 41.262101273151096, 90, 253.24635012026997, 189.53880561764117], [51.74726663344763, 90, 120.33108308296265, 49.763121907312545, 90, 131.19312946710414, 184.7814997032023], [47.79673681903229, 90, 201.7059023602073, 51.16325026124113, 90, 140.72934241262493, 189.53880561764117], [52.004359792233274, 90, 256.6241398429291, 48.44427919692167, 90, 317.4261298105409, 210.36453368432618], [51.655383417669334, 90, 277.11632983416433, 39.44589413750743, 90, 7.270692107687826, 151.86240231829092], [51.26503502297843, 90, 239.40004746654898, 41.58406123327792, 90, 251.1972914113363, 151.86240231829092], [51.54375895065756, 90, 239.40004746654898, 50.922747501052555, 90, 96.03518767730391, 174.49171904598907], [51.54375895065756, 90, 2.184307230365947, 48.52237783458847, 90, 202.0395649813902, 157.9138877721893], [41.36855072803073, 90, 17.809632929070716, 51.53177681225462, 90, 253.24635012026997, 178.10709001500345], [51.74726663344763, 90, 194.4975698920072, 50.06497042791354, 90, 208.52687437379112, 178.10709001500345], [51.655383417669334, 90, 262.92557148914875, 44.46920653847641, 90, 253.24635012026997, 189.53880561764117], [52.004359792233274, 90, 207.06116785155479, 50.180241957979845, 90, 347.31035907115137, 189.53880561764117], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 339.3041705956085, 151.86240231829092], [51.655383417669334, 90, 269.0755470746629, 49.366734541953235, 90, 202.0395649813902, 219.28752426229048], [51.78608070553043, 90, 273.62722827419014, 39.47660048428726, 90, 110.62505164266636, 157.9138877721893], [51.26503502297843, 90, 17.809632929070716, 50.58910374560642, 90, 264.4668029114462, 47.86421256288543], [52.004359792233274, 90, 327.17353915591923, 48.871703222824806, 90, 258.332206048757, 181.28225665415536], [51.72874261354272, 90, 59.09673586497625, 51.16325026124113, 90, 322.7099304072282, 146.03146260908062], [43.16383779843137, 90, 178.31499039017882, 51.16325026124113, 90, 347.31035907115137, 175.2611747415753], [51.68949795508055, 90, 273.62722827419014, 46.65356364138034, 90, 110.62505164266636, 95.56981088493696], [52.04006385047204, 90, 194.4975698920072, 41.55417322262388, 90, 227.43391204709008, 183.90409127690782], [51.655383417669334, 90, 17.809632929070716, 48.871703222824806, 90, 347.31035907115137, 174.49171904598907], [52.004359792233274, 90, 194.4975698920072, 46.04657686559747, 90, 253.24635012026997, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.315569125002696, 90, 281.56477646650535, 189.53880561764117], [46.699834537330844, 90, 241.44986572925654, 49.59035060649161, 90, 131.19312946710414, 170.39039894515142], [51.54375895065756, 90, 194.4975698920072, 50.06497042791354, 90, 317.4261298105409, 170.39039894515142], [52.004359792233274, 90, 184.16159102114605, 51.16325026124113, 90, 347.31035907115137, 157.9138877721893], [51.74726663344763, 90, 277.11632983416433, 44.69557041931423, 90, 110.62505164266636, 174.49171904598907], [51.54375895065756, 90, 184.16159102114605, 51.23984508435372, 90, 322.7099304072282, 146.03146260908062], [51.68949795508055, 90, 277.11632983416433, 50.640982156834916, 90, 96.03518767730391, 144.79165932836142], [52.04006385047204, 90, 216.07833240167224, 43.767956269223355, 90, 96.03518767730391, 174.49171904598907], [51.655383417669334, 90, 277.11632983416433, 48.44427919692167, 90, 131.19312946710414, 170.39039894515142], [46.699834537330844, 90, 241.44986572925654, 44.58551586629767, 90, 317.4261298105409, 210.36453368432618], [52.004359792233274, 90, 178.31499039017882, 51.16325026124113, 90, 253.24635012026997, 275.2585578615196], [51.78608070553043, 90, 273.62722827419014, 44.71073719507391, 90, 298.8163104632298, 297.91803490537706], [43.16383779843137, 90, 59.09673586497625, 39.29064042850271, 90, 347.31035907115137, 189.53880561764117], [49.889055712118335, 90, 106.49480693305028, 51.16325026124113, 90, 110.62505164266636, 308.71954602297035], [46.88530387207054, 90, 262.92557148914875, 40.44241342648366, 90, 317.4261298105409, 210.36453368432618], [51.655383417669334, 90, 277.11632983416433, 48.44427919692167, 90, 258.332206048757, 99.19388216417686], [51.72874261354272, 90, 2.184307230365947, 42.395299596408016, 90, 347.31035907115137, 148.58175466933884], [47.10793712458702, 90, 178.31499039017882, 44.14092340969059, 90, 3.9982635768539154, 210.23142005943166], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [51.655383417669334, 90, 262.92557148914875, 44.46920653847641, 90, 96.03518767730391, 178.10709001500345], [51.72874261354272, 90, 17.809632929070716, 44.50466855109846, 90, 258.332206048757, 162.08222610452592], [50.769633076686034, 90, 277.11632983416433, 39.25082862161363, 90, 258.332206048757, 174.4490613585338], [52.004359792233274, 90, 194.4975698920072, 41.1848915119551, 90, 238.8649847669475, 358.5994107788613], [51.655383417669334, 90, 256.6241398429291, 42.40992096385008, 90, 7.270692107687826, 129.6457157727014], [51.54375895065756, 90, 239.40004746654898, 44.004013253078945, 90, 322.7099304072282, 146.03146260908062], [50.51800344674469, 90, 17.809632929070716, 41.394781108565596, 90, 301.8164954259951, 232.21147598297784], [52.004359792233274, 90, 352.9660409595596, 48.5724849114406, 90, 347.31035907115137, 289.7104015724736], [42.29558510098571, 90, 17.809632929070716, 51.70242571441147, 90, 131.19312946710414, 178.10709001500345], [42.29558510098571, 90, 17.809632929070716, 51.16325026124113, 90, 298.8163104632298, 183.90409127690782], [51.26503502297843, 90, 327.17353915591923, 48.871703222824806, 90, 110.62505164266636, 178.10709001500345], [47.83822743384326, 90, 277.11632983416433, 51.16325026124113, 90, 264.4668029114462, 189.53880561764117], [47.83822743384326, 90, 2.184307230365947, 51.16325026124113, 90, 110.62505164266636, 157.9138877721893], [50.51800344674469, 90, 49.173812578275786, 51.16325026124113, 90, 265.0947434797261, 174.49171904598907], [41.22377216049031, 90, 49.173812578275786, 48.6547931058651, 90, 110.62505164266636, 157.9138877721893], [52.004359792233274, 90, 2.184307230365947, 50.10333280096795, 90, 110.62505164266636, 185.8957454014407], [49.889055712118335, 90, 241.44986572925654, 49.34886557596016, 90, 347.31035907115137, 189.53880561764117], [51.74726663344763, 90, 255.3445764128222, 50.14141287122858, 90, 258.332206048757, 133.34341212157588], [47.10793712458702, 90, 277.11632983416433, 44.69557041931423, 90, 96.03518767730391, 174.49171904598907], [51.54375895065756, 90, 239.40004746654898, 50.922747501052555, 90, 251.1972914113363, 151.86240231829092], [51.78608070553043, 90, 273.62722827419014, 50.06497042791354, 90, 110.62505164266636, 219.28752426229048], [51.655383417669334, 90, 207.06116785155479, 46.65356364138034, 90, 317.4261298105409, 341.4963678065458], [52.004359792233274, 90, 2.184307230365947, 49.34886557596016, 90, 258.332206048757, 173.4902910479415], [52.004359792233274, 90, 241.44986572925654, 51.16325026124113, 90, 339.3041705956085, 183.90409127690782], [51.54375895065756, 90, 17.809632929070716, 48.5724849114406, 90, 227.43391204709008, 148.58175466933884], [52.004359792233274, 90, 17.809632929070716, 49.315569125002696, 90, 301.8164954259951, 306.14781952483617], [52.004359792233274, 90, 277.11632983416433, 39.25082862161363, 90, 258.332206048757, 48.787020107426116], [51.655383417669334, 90, 262.92557148914875, 44.46920653847641, 90, 258.332206048757, 162.08222610452592], [52.004359792233274, 90, 17.809632929070716, 50.6550773161958, 90, 339.3041705956085, 219.28752426229048], [47.10793712458702, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 174.49171904598907], [51.78608070553043, 90, 178.31499039017882, 51.70242571441147, 90, 227.43391204709008, 162.08222610452592], [51.26503502297843, 90, 201.7059023602073, 48.50026596293891, 90, 347.31035907115137, 183.90409127690782], [51.54375895065756, 90, 286.7708670864571, 39.47660048428726, 90, 110.62505164266636, 219.28752426229048], [51.78608070553043, 90, 273.62722827419014, 48.7951991363241, 90, 322.7099304072282, 146.03146260908062], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [51.74726663344763, 90, 207.06116785155479, 46.65356364138034, 90, 347.31035907115137, 82.79974358782187], [51.54375895065756, 90, 239.40004746654898, 50.922747501052555, 90, 251.1972914113363, 151.86240231829092], [51.74726663344763, 90, 207.06116785155479, 46.65356364138034, 90, 347.31035907115137, 82.79974358782187], [52.04006385047204, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [51.74726663344763, 90, 207.06116785155479, 49.315569125002696, 90, 258.332206048757, 218.96069930743383], [51.655383417669334, 90, 207.06116785155479, 48.1146400944502, 90, 317.4261298105409, 210.36453368432618], [52.004359792233274, 90, 2.184307230365947, 45.063045824345075, 90, 347.31035907115137, 151.86240231829092], [52.004359792233274, 90, 255.3445764128222, 50.889662428248066, 90, 131.19312946710414, 189.53880561764117], [43.16383779843137, 90, 59.09673586497625, 51.16325026124113, 90, 96.03518767730391, 174.49171904598907], [52.004359792233274, 90, 277.11632983416433, 42.41175697508773, 90, 131.19312946710414, 184.7814997032023], [51.74726663344763, 90, 201.7059023602073, 51.16325026124113, 90, 339.3041705956085, 189.53880561764117], [43.16383779843137, 90, 277.11632983416433, 41.251630710118675, 90, 258.332206048757, 210.36453368432618], [48.91168247017528, 90, 17.809632929070716, 49.315569125002696, 90, 317.4261298105409, 169.30224916641635], [47.10793712458702, 90, 323.5110467413477, 43.03755252064701, 90, 317.4261298105409, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.315569125002696, 90, 347.31035907115137, 153.012052306212], [46.88530387207054, 90, 262.92557148914875, 40.44241342648366, 90, 227.43391204709008, 183.90409127690782], [51.78608070553043, 90, 277.11632983416433, 45.13122052374482, 90, 347.31035907115137, 216.4534141142473], [51.26503502297843, 90, 323.5110467413477, 43.03755252064701, 90, 131.19312946710414, 350.0850767347009], [51.78608070553043, 90, 184.16159102114605, 45.944864344406184, 90, 143.1672368450601, 256.9758328380566], [51.78608070553043, 90, 2.184307230365947, 45.76623006809402, 90, 258.332206048757, 162.08222610452592], [52.004359792233274, 90, 352.9660409595596, 51.16325026124113, 90, 281.56477646650535, 142.8821079550158], [51.655383417669334, 90, 17.809632929070716, 41.394781108565596, 90, 110.62505164266636, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.07398948115247, 90, 301.8164954259951, 32.67518193579858], [51.74726663344763, 90, 194.4975698920072, 50.06497042791354, 90, 208.52687437379112, 178.10709001500345], [52.004359792233274, 90, 352.9660409595596, 42.35299874146539, 90, 281.56477646650535, 76.05926326849963], [46.88530387207054, 90, 17.809632929070716, 49.315569125002696, 90, 281.56477646650535, 189.53880561764117], [51.54375895065756, 90, 59.09673586497625, 41.58406123327792, 90, 258.332206048757, 95.56981088493696], [52.04006385047204, 90, 327.17353915591923, 51.16325026124113, 90, 264.4668029114462, 351.0442529979686], [46.88530387207054, 90, 256.6241398429291, 48.55105961265041, 90, 96.03518767730391, 74.18210611049284], [51.54375895065756, 90, 207.06116785155479, 40.95539081238441, 90, 251.1972914113363, 159.70060580500873], [52.04006385047204, 90, 201.7059023602073, 49.315569125002696, 90, 258.332206048757, 183.90409127690782], [49.889055712118335, 90, 277.11632983416433, 48.353450317606026, 90, 339.3041705956085, 151.86240231829092], [43.16383779843137, 90, 49.173812578275786, 48.871703222824806, 90, 258.332206048757, 157.9138877721893], [51.74726663344763, 90, 239.40004746654898, 51.16325026124113, 90, 208.52687437379112, 178.10709001500345], [51.74726663344763, 90, 194.4975698920072, 50.06497042791354, 90, 110.62505164266636, 178.10709001500345], [51.26503502297843, 90, 239.40004746654898, 45.97821651162834, 90, 7.270692107687826, 173.4902910479415], [52.004359792233274, 90, 160.33951292208033, 45.00186463377087, 90, 140.72934241262493, 189.53880561764117], [51.68949795508055, 90, 286.7708670864571, 40.813632593041376, 90, 140.72934241262493, 51.38241782276611], [50.34928149245797, 90, 352.9660409595596, 51.16325026124113, 90, 347.31035907115137, 159.70060580500873], [50.769633076686034, 90, 277.11632983416433, 51.16325026124113, 90, 347.31035907115137, 95.56981088493696], [51.74726663344763, 90, 2.184307230365947, 45.944864344406184, 90, 110.62505164266636, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 40.18975132197542, 90, 298.8163104632298, 162.24395451854465], [50.51800344674469, 90, 160.33951292208033, 45.65131043084898, 90, 198.77650654243985, 129.4656407104516], [42.29558510098571, 90, 17.809632929070716, 48.871703222824806, 90, 258.332206048757, 179.71578576548197], [47.79673681903229, 90, 255.3445764128222, 44.004013253078945, 90, 110.62505164266636, 146.03146260908062], [51.74726663344763, 90, 17.809632929070716, 41.46443832524679, 90, 110.62505164266636, 144.79165932836142], [51.68949795508055, 90, 273.62722827419014, 46.65356364138034, 90, 131.19312946710414, 95.56981088493696], [46.88530387207054, 90, 59.09673586497625, 41.262101273151096, 90, 110.62505164266636, 157.9138877721893], [52.004359792233274, 90, 184.16159102114605, 51.16325026124113, 90, 253.24635012026997, 189.53880561764117], [50.51800344674469, 90, 277.11632983416433, 48.353450317606026, 90, 339.3041705956085, 157.9138877721893], [43.16383779843137, 90, 194.4975698920072, 44.69557041931423, 90, 96.03518767730391, 133.34341212157588], [46.699834537330844, 90, 277.11632983416433, 44.69557041931423, 90, 281.56477646650535, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.315569125002696, 90, 265.0947434797261, 149.091772715771], [52.004359792233274, 90, 178.31499039017882, 51.70242571441147, 90, 347.31035907115137, 189.53880561764117], [51.72874261354272, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 2.5239264026285912], [49.889055712118335, 90, 239.40004746654898, 49.34886557596016, 90, 281.56477646650535, 151.86240231829092], [51.655383417669334, 90, 269.0755470746629, 49.366734541953235, 90, 347.31035907115137, 178.10709001500345], [47.83822743384326, 90, 239.40004746654898, 49.34886557596016, 90, 96.03518767730391, 157.9138877721893], [49.889055712118335, 90, 277.11632983416433, 51.16325026124113, 90, 110.62505164266636, 332.50222979305863], [43.16383779843137, 90, 59.09673586497625, 51.16325026124113, 90, 347.31035907115137, 175.2611747415753], [49.889055712118335, 90, 239.40004746654898, 41.262101273151096, 90, 110.62505164266636, 155.9662287184126], [43.16383779843137, 90, 277.11632983416433, 48.353450317606026, 90, 8.63496392244571, 170.33827927616656], [43.16383779843137, 90, 194.4975698920072, 47.809676423875565, 90, 339.3041705956085, 290.59909822596103], [52.004359792233274, 90, 277.11632983416433, 39.25082862161363, 90, 258.332206048757, 174.4490613585338], [46.110668261251696, 90, 273.62722827419014, 46.65356364138034, 90, 96.03518767730391, 50.40365314793928], [46.88530387207054, 90, 277.11632983416433, 51.16325026124113, 90, 347.31035907115137, 216.4534141142473], [51.74726663344763, 90, 239.40004746654898, 51.16325026124113, 90, 110.62505164266636, 178.10709001500345], [47.10793712458702, 90, 277.11632983416433, 40.976005007347034, 90, 110.62505164266636, 349.17521494875], [51.655383417669334, 90, 277.11632983416433, 51.042815989887174, 90, 96.03518767730391, 189.53880561764117], [40.70071799729816, 90, 184.16159102114605, 39.82772829998764, 90, 251.1972914113363, 189.53880561764117], [52.004359792233274, 90, 277.11632983416433, 49.59035060649161, 90, 339.3041705956085, 189.53880561764117], [46.699834537330844, 90, 256.6241398429291, 50.10333280096795, 90, 110.62505164266636, 170.39039894515142], [46.88530387207054, 90, 2.184307230365947, 45.76623006809402, 90, 347.31035907115137, 208.67143291963504], [51.78608070553043, 90, 262.92557148914875, 40.44241342648366, 90, 227.43391204709008, 183.90409127690782], [48.060441279222275, 90, 2.184307230365947, 48.48249190858248, 90, 298.8163104632298, 285.8498818322806], [51.54375895065756, 90, 239.40004746654898, 50.954811893906935, 90, 251.1972914113363, 151.86240231829092], [52.004359792233274, 90, 59.09673586497625, 46.56231715061847, 90, 238.8649847669475, 189.53880561764117], [46.699834537330844, 90, 49.173812578275786, 51.16325026124113, 90, 253.24635012026997, 170.39039894515142], [52.04006385047204, 90, 17.809632929070716, 43.02196238271181, 90, 96.03518767730391, 183.90409127690782], [43.16383779843137, 90, 216.07833240167224, 48.353450317606026, 90, 339.3041705956085, 189.53880561764117], [51.54375895065756, 90, 256.6241398429291, 48.5724849114406, 90, 7.270692107687826, 129.6457157727014], [46.88530387207054, 90, 262.92557148914875, 40.44241342648366, 90, 347.31035907115137, 91.69829066809625], [50.769633076686034, 90, 194.4975698920072, 51.16325026124113, 90, 258.332206048757, 216.4534141142473], [47.10793712458702, 90, 106.49480693305028, 50.10333280096795, 90, 301.8164954259951, 174.49171904598907], [52.004359792233274, 90, 17.809632929070716, 50.6550773161958, 90, 339.3041705956085, 219.28752426229048], [46.88530387207054, 90, 277.11632983416433, 51.16325026124113, 90, 347.31035907115137, 216.4534141142473], [52.004359792233274, 90, 277.11632983416433, 43.54465449688659, 90, 339.3041705956085, 189.53880561764117], [52.004359792233274, 90, 17.809632929070716, 46.790805271561055, 90, 301.8164954259951, 174.49171904598907], [52.004359792233274, 90, 17.809632929070716, 50.58910374560642, 90, 258.332206048757, 181.28225665415536], [51.74726663344763, 90, 194.4975698920072, 51.16325026124113, 90, 140.72934241262493, 189.53880561764117], [47.10793712458702, 90, 49.173812578275786, 46.51900403680126, 90, 347.31035907115137, 189.53880561764117], [51.78608070553043, 90, 178.31499039017882, 51.70242571441147, 90, 253.24635012026997, 178.10709001500345], [52.004359792233274, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 2.5239264026285912], [51.74726663344763, 90, 2.184307230365947, 49.7539914850465, 90, 110.62505164266636, 82.79974358782187], [50.51800344674469, 90, 49.173812578275786, 51.16325026124113, 90, 317.4261298105409, 106.99022419032062], [46.88530387207054, 90, 59.09673586497625, 41.262101273151096, 90, 140.72934241262493, 157.9138877721893], [51.68949795508055, 90, 286.7708670864571, 40.813632593041376, 90, 110.62505164266636, 51.38241782276611], [52.004359792233274, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 294.09162187400847], [51.78608070553043, 90, 216.07833240167224, 50.35601017167101, 90, 96.03518767730391, 174.49171904598907], [51.78608070553043, 90, 178.31499039017882, 51.70242571441147, 90, 227.43391204709008, 183.90409127690782], [47.10793712458702, 90, 323.5110467413477, 43.03755252064701, 90, 322.7099304072282, 21.767118774531205], [52.004359792233274, 90, 194.4975698920072, 46.04657686559747, 90, 110.62505164266636, 157.9138877721893], [46.88530387207054, 90, 17.809632929070716, 41.262101273151096, 90, 253.24635012026997, 189.53880561764117], [47.10793712458702, 90, 2.184307230365947, 42.395299596408016, 90, 3.9982635768539154, 210.23142005943166], [52.004359792233274, 90, 286.7708670864571, 51.70242571441147, 90, 298.8163104632298, 280.68786360798305], [51.74726663344763, 90, 269.0755470746629, 49.366734541953235, 90, 347.31035907115137, 178.10709001500345], [51.655383417669334, 90, 2.184307230365947, 51.16325026124113, 90, 131.19312946710414, 329.6392095351034], [51.54375895065756, 90, 239.40004746654898, 50.922747501052555, 90, 208.52687437379112, 189.53880561764117], [42.29558510098571, 90, 2.184307230365947, 51.16325026124113, 90, 251.1972914113363, 350.0850767347009], [51.74726663344763, 90, 194.4975698920072, 50.06497042791354, 90, 208.52687437379112, 178.10709001500345], [50.51800344674469, 90, 49.173812578275786, 51.16325026124113, 90, 265.0947434797261, 174.49171904598907], [52.04006385047204, 90, 184.16159102114605, 43.53862133199943, 90, 253.24635012026997, 178.10709001500345], [52.004359792233274, 90, 352.9660409595596, 45.80019557709853, 90, 298.8163104632298, 352.50734553747185], [51.655383417669334, 90, 106.49480693305028, 40.44241342648366, 90, 258.332206048757, 133.34341212157588], [51.74726663344763, 90, 207.06116785155479, 51.16325026124113, 90, 347.31035907115137, 314.3574062205035], [42.29558510098571, 90, 17.809632929070716, 52.168214542601945, 90, 140.72934241262493, 167.2100454604708], [52.004359792233274, 90, 277.11632983416433, 51.70242571441147, 90, 131.19312946710414, 178.10709001500345], [52.004359792233274, 90, 352.9660409595596, 45.80019557709853, 90, 298.8163104632298, 148.58175466933884], [51.54375895065756, 90, 17.809632929070716, 48.5724849114406, 90, 258.332206048757, 352.50734553747185], [52.004359792233274, 90, 24.904064150366942, 50.06497042791354, 90, 251.1972914113363, 133.07454031232854], [52.004359792233274, 90, 2.184307230365947, 48.55105961265041, 90, 110.62505164266636, 174.49171904598907], [50.51800344674469, 90, 184.16159102114605, 43.53862133199943, 90, 96.03518767730391, 174.49171904598907], [51.655383417669334, 90, 178.31499039017882, 51.16325026124113, 90, 298.8163104632298, 162.02701630524024], [52.004359792233274, 90, 207.06116785155479, 50.180241957979845, 90, 339.3041705956085, 129.4656407104516], [52.004359792233274, 90, 17.809632929070716, 50.50660074562417, 90, 198.77650654243985, 151.86240231829092], [50.51800344674469, 90, 17.809632929070716, 52.168214542601945, 90, 140.72934241262493, 189.53880561764117], [52.004359792233274, 90, 277.11632983416433, 44.900643535270675, 90, 251.1972914113363, 307.9443016396073], [52.04006385047204, 90, 184.16159102114605, 43.53862133199943, 90, 253.24635012026997, 178.10709001500345], [47.83822743384326, 90, 277.11632983416433, 51.16325026124113, 90, 110.62505164266636, 189.53880561764117], [52.004359792233274, 90, 255.3445764128222, 50.889662428248066, 90, 96.03518767730391, 332.50222979305863], [46.88530387207054, 90, 59.09673586497625, 47.84654303879842, 90, 131.19312946710414, 327.78051409871694], [52.004359792233274, 90, 17.809632929070716, 41.251630710118675, 90, 110.62505164266636, 178.10709001500345], [51.655383417669334, 90, 49.173812578275786, 50.99348064935067, 90, 258.332206048757, 95.56981088493696], [52.004359792233274, 90, 17.809632929070716, 50.58910374560642, 90, 258.332206048757, 181.28225665415536], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 166.84280696596738], [52.004359792233274, 90, 178.31499039017882, 51.70242571441147, 90, 202.0395649813902, 157.9138877721893], [51.78608070553043, 90, 17.809632929070716, 41.394781108565596, 90, 227.43391204709008, 183.90409127690782], [47.83822743384326, 90, 277.11632983416433, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 110.62505164266636, 157.9138877721893], [51.78608070553043, 90, 178.31499039017882, 45.80019557709853, 90, 298.8163104632298, 352.50734553747185], [50.51800344674469, 90, 194.4975698920072, 44.69557041931423, 90, 96.03518767730391, 133.34341212157588], [50.51800344674469, 90, 17.809632929070716, 39.82772829998764, 90, 238.8649847669475, 219.28752426229048], [50.51800344674469, 90, 194.4975698920072, 50.38676443481272, 90, 347.31035907115137, 158.92055202169735], [47.10793712458702, 90, 2.184307230365947, 44.004013253078945, 90, 38.95166041297089, 133.34341212157588], [51.26503502297843, 90, 262.92557148914875, 49.683107606702656, 90, 3.9982635768539154, 210.23142005943166], [51.54375895065756, 90, 239.40004746654898, 43.94761505568717, 90, 251.1972914113363, 151.86240231829092], [46.88530387207054, 90, 256.6241398429291, 50.922747501052555, 90, 264.4668029114462, 351.0442529979686], [43.16383779843137, 90, 17.809632929070716, 41.394781108565596, 90, 258.332206048757, 210.36453368432618], [52.004359792233274, 90, 17.809632929070716, 47.106173110337394, 90, 258.332206048757, 210.36453368432618], [51.68949795508055, 90, 184.16159102114605, 41.81394055098976, 90, 322.7099304072282, 357.04073962261384], [51.26503502297843, 90, 277.11632983416433, 41.58406123327792, 90, 347.31035907115137, 189.53880561764117], [52.004359792233274, 90, 277.11632983416433, 51.16325026124113, 90, 131.19312946710414, 183.90409127690782], [51.74726663344763, 90, 241.44986572925654, 51.16325026124113, 90, 339.3041705956085, 189.53880561764117], [43.16383779843137, 90, 277.11632983416433, 41.251630710118675, 90, 258.332206048757, 210.36453368432618], [51.74726663344763, 90, 277.11632983416433, 44.69557041931423, 90, 110.62505164266636, 174.49171904598907], [46.110668261251696, 90, 273.62722827419014, 46.65356364138034, 90, 131.19312946710414, 14.157530606790484], [46.88530387207054, 90, 256.6241398429291, 50.10333280096795, 90, 110.62505164266636, 22.520148638376938], [50.51800344674469, 90, 207.06116785155479, 42.66587425902648, 90, 265.0947434797261, 174.49171904598907], [51.655383417669334, 90, 49.173812578275786, 51.16325026124113, 90, 317.4261298105409, 210.36453368432618], [51.68949795508055, 90, 327.17353915591923, 43.81803406967037, 90, 110.62505164266636, 189.53880561764117], [51.26503502297843, 90, 273.62722827419014, 46.65356364138034, 90, 347.31035907115137, 174.49171904598907], [52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 131.19312946710414, 208.3115425025094], [43.16383779843137, 90, 194.4975698920072, 47.809676423875565, 90, 339.3041705956085, 175.24409852524943], [51.54375895065756, 90, 239.40004746654898, 50.922747501052555, 90, 251.1972914113363, 124.26741230774482], [52.004359792233274, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 189.53880561764117], [51.54375895065756, 90, 286.7708670864571, 40.44241342648366, 90, 298.8163104632298, 122.07213547430769], [46.88530387207054, 90, 256.6241398429291, 50.10333280096795, 90, 110.62505164266636, 22.520148638376938], [52.004359792233274, 90, 277.11632983416433, 51.525268357338646, 90, 347.31035907115137, 178.10709001500345], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [47.10793712458702, 90, 277.11632983416433, 44.69557041931423, 90, 96.03518767730391, 174.49171904598907], [52.04006385047204, 90, 184.16159102114605, 45.05920374910967, 90, 227.43391204709008, 183.90409127690782], [51.68949795508055, 90, 106.49480693305028, 48.83569846533601, 90, 258.332206048757, 210.36453368432618], [51.78608070553043, 90, 277.11632983416433, 48.871703222824806, 90, 140.72934241262493, 44.2098991131884], [51.54375895065756, 90, 273.62722827419014, 51.16325026124113, 90, 322.7099304072282, 55.3995062425449], [51.78608070553043, 90, 106.49480693305028, 51.16325026124113, 90, 110.62505164266636, 214.11058655867066], [41.22377216049031, 90, 256.6241398429291, 50.10333280096795, 90, 347.31035907115137, 148.58175466933884], [51.54375895065756, 90, 207.06116785155479, 44.290949765304845, 90, 96.03518767730391, 189.53880561764117], [42.29558510098571, 90, 2.184307230365947, 51.16325026124113, 90, 317.4261298105409, 169.30224916641635], [48.91168247017528, 90, 17.809632929070716, 49.315569125002696, 90, 251.1972914113363, 350.0850767347009], [52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 110.62505164266636, 219.28752426229048], [52.004359792233274, 90, 294.44516267386354, 48.86674930304957, 90, 131.19312946710414, 17.375517992959324], [51.74726663344763, 90, 241.44986572925654, 51.16325026124113, 90, 339.3041705956085, 33.76118292705689], [52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 131.19312946710414, 183.90409127690782], [51.78608070553043, 90, 273.62722827419014, 51.16325026124113, 90, 110.62505164266636, 214.11058655867066], [50.51800344674469, 90, 277.11632983416433, 50.640982156834916, 90, 198.77650654243985, 317.07786907958996], [51.72874261354272, 90, 269.0755470746629, 49.366734541953235, 90, 202.0395649813902, 157.9138877721893], [51.655383417669334, 90, 178.31499039017882, 51.70242571441147, 90, 347.31035907115137, 189.53880561764117], [47.10793712458702, 90, 277.11632983416433, 43.34854903869433, 90, 96.03518767730391, 189.53880561764117], [47.79673681903229, 90, 255.3445764128222, 40.976005007347034, 90, 110.62505164266636, 95.56981088493696], [50.51800344674469, 90, 178.31499039017882, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [51.72874261354272, 90, 194.4975698920072, 44.89613657282584, 90, 265.0947434797261, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.315569125002696, 90, 281.56477646650535, 189.53880561764117], [49.889055712118335, 90, 49.173812578275786, 48.871703222824806, 90, 258.332206048757, 151.86240231829092], [51.26503502297843, 90, 352.9660409595596, 51.16325026124113, 90, 253.24635012026997, 189.53880561764117], [52.004359792233274, 90, 178.31499039017882, 43.68124304437765, 90, 3.9982635768539154, 189.53880561764117], [52.004359792233274, 90, 256.6241398429291, 50.10333280096795, 90, 253.24635012026997, 189.53880561764117], [46.88530387207054, 90, 194.4975698920072, 46.04657686559747, 90, 110.62505164266636, 22.520148638376938], [52.004359792233274, 90, 17.809632929070716, 44.50466855109846, 90, 96.03518767730391, 178.10709001500345], [40.57394503990107, 90, 17.809632929070716, 49.315569125002696, 90, 298.8163104632298, 148.58175466933884], [46.88530387207054, 90, 17.809632929070716, 42.792176262780345, 90, 347.31035907115137, 216.4534141142473], [46.88530387207054, 90, 277.11632983416433, 51.16325026124113, 90, 38.95166041297089, 322.65366478495054], [52.004359792233274, 90, 17.809632929070716, 50.50660074562417, 90, 198.77650654243985, 129.4656407104516], [46.699834537330844, 90, 49.173812578275786, 44.35042514953808, 90, 38.95166041297089, 178.10709001500345], [50.51800344674469, 90, 17.809632929070716, 48.6547931058651, 90, 140.72934241262493, 189.53880561764117], [46.699834537330844, 90, 49.173812578275786, 39.82772829998764, 90, 298.8163104632298, 219.28752426229048], [50.51800344674469, 90, 59.09673586497625, 51.16325026124113, 90, 238.8649847669475, 219.28752426229048], [51.54375895065756, 90, 256.6241398429291, 48.5724849114406, 90, 7.270692107687826, 129.6457157727014], [47.10793712458702, 90, 194.4975698920072, 49.59035060649161, 90, 3.9982635768539154, 162.08222610452592], [52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 253.24635012026997, 178.10709001500345], [51.54375895065756, 90, 207.06116785155479, 44.290949765304845, 90, 96.03518767730391, 189.53880561764117], [46.699834537330844, 90, 49.173812578275786, 44.004013253078945, 90, 38.95166041297089, 178.10709001500345], [52.004359792233274, 90, 160.33951292208033, 45.00186463377087, 90, 7.270692107687826, 173.4902910479415], [51.54375895065756, 90, 17.809632929070716, 48.5724849114406, 90, 258.332206048757, 148.58175466933884], [51.655383417669334, 90, 17.809632929070716, 47.19192397223499, 90, 275.0236051450618, 144.79165932836142], [51.54375895065756, 90, 207.06116785155479, 40.95539081238441, 90, 251.1972914113363, 159.70060580500873], [52.004359792233274, 90, 160.33951292208033, 41.251630710118675, 90, 265.0947434797261, 238.6176425458319], [46.88530387207054, 90, 17.809632929070716, 51.16325026124113, 90, 110.62505164266636, 157.9138877721893], [51.54375895065756, 90, 262.92557148914875, 44.004013253078945, 90, 38.95166041297089, 133.34341212157588], [51.655383417669334, 90, 255.3445764128222, 44.900643535270675, 90, 251.1972914113363, 338.22448873412145], [51.26503502297843, 90, 239.40004746654898, 41.58406123327792, 90, 96.03518767730391, 174.49171904598907], [52.004359792233274, 90, 2.184307230365947, 50.99348064935067, 90, 131.19312946710414, 14.157530606790484], [52.004359792233274, 90, 207.06116785155479, 39.33943622463865, 90, 322.7099304072282, 194.1537065099924], [50.769633076686034, 90, 194.4975698920072, 51.16325026124113, 90, 347.31035907115137, 91.69829066809625], [51.78608070553043, 90, 178.31499039017882, 51.70242571441147, 90, 227.43391204709008, 183.90409127690782], [52.004359792233274, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 2.5239264026285912], [51.78608070553043, 90, 178.31499039017882, 51.16325026124113, 90, 253.24635012026997, 178.10709001500345], [52.004359792233274, 90, 262.92557148914875, 40.44241342648366, 90, 119.55795142113953, 210.36453368432618], [51.74726663344763, 90, 49.173812578275786, 50.06497042791354, 90, 347.31035907115137, 314.3574062205035], [51.74726663344763, 90, 207.06116785155479, 51.16325026124113, 90, 208.52687437379112, 178.10709001500345], [49.889055712118335, 90, 239.40004746654898, 49.34886557596016, 90, 317.4261298105409, 189.53880561764117], [51.54375895065756, 90, 256.6241398429291, 42.40992096385008, 90, 7.270692107687826, 129.6457157727014], [51.78608070553043, 90, 262.92557148914875, 40.44241342648366, 90, 347.31035907115137, 183.90409127690782], [51.74726663344763, 90, 49.173812578275786, 44.004013253078945, 90, 227.43391204709008, 189.53880561764117], [52.004359792233274, 90, 269.0755470746629, 49.366734541953235, 90, 258.332206048757, 133.34341212157588], [52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 317.4261298105409, 189.53880561764117], [51.54375895065756, 90, 239.40004746654898, 50.922747501052555, 90, 208.52687437379112, 189.53880561764117], [50.51800344674469, 90, 160.33951292208033, 45.65131043084898, 90, 198.77650654243985, 129.4656407104516], [51.655383417669334, 90, 17.809632929070716, 51.16325026124113, 90, 258.332206048757, 247.40385972188412], [47.10793712458702, 90, 277.11632983416433, 39.25082862161363, 90, 258.332206048757, 133.34341212157588], [52.004359792233274, 90, 132.84754296375456, 51.16325026124113, 90, 96.03518767730391, 144.79165932836142], [51.655383417669334, 90, 17.809632929070716, 41.46443832524679, 90, 131.19312946710414, 162.08222610452592], [51.26503502297843, 90, 17.809632929070716, 42.792176262780345, 90, 208.52687437379112, 104.82678825105292], [52.004359792233274, 90, 239.40004746654898, 48.5724849114406, 90, 347.31035907115137, 189.53880561764117], [43.16383779843137, 90, 277.11632983416433, 41.251630710118675, 90, 275.0236051450618, 210.36453368432618], [50.51800344674469, 90, 17.809632929070716, 47.34522883586661, 90, 258.332206048757, 144.79165932836142], [52.004359792233274, 90, 294.44516267386354, 48.86674930304957, 90, 131.19312946710414, 149.41468925894623], [51.74726663344763, 90, 2.184307230365947, 49.763121907312545, 90, 347.31035907115137, 148.58175466933884], [42.29558510098571, 90, 2.184307230365947, 51.16325026124113, 90, 298.8163104632298, 36.40340756762328], [51.54375895065756, 90, 184.16159102114605, 51.23984508435372, 90, 322.7099304072282, 146.03146260908062], [51.54375895065756, 90, 17.809632929070716, 51.16325026124113, 90, 253.24635012026997, 189.53880561764117], [52.004359792233274, 90, 184.16159102114605, 49.315569125002696, 90, 281.56477646650535, 189.53880561764117], [51.54375895065756, 90, 256.6241398429291, 48.5724849114406, 90, 7.270692107687826, 129.6457157727014], [51.26503502297843, 90, 262.92557148914875, 44.004013253078945, 90, 38.95166041297089, 133.34341212157588], [52.004359792233274, 90, 17.809632929070716, 49.59035060649161, 90, 339.3041705956085, 189.53880561764117], [52.004359792233274, 90, 277.11632983416433, 44.50466855109846, 90, 96.03518767730391, 178.10709001500345], [51.74726663344763, 90, 194.4975698920072, 46.51900403680126, 90, 347.31035907115137, 189.53880561764117], [51.655383417669334, 90, 178.31499039017882, 41.825931693275855, 90, 298.8163104632298, 162.02701630524024], [47.83822743384326, 90, 294.44516267386354, 49.315569125002696, 90, 347.31035907115137, 189.53880561764117], [52.04006385047204, 90, 277.11632983416433, 51.16325026124113, 90, 110.62505164266636, 157.9138877721893], [46.699834537330844, 90, 17.809632929070716, 48.871703222824806, 90, 317.4261298105409, 210.36453368432618], [46.88530387207054, 90, 262.92557148914875, 40.44241342648366, 90, 258.332206048757, 216.4534141142473], [50.51800344674469, 90, 160.33951292208033, 41.859117131539094, 90, 8.63496392244571, 178.10709001500345], [52.004359792233274, 90, 2.184307230365947, 50.48928029152833, 90, 3.9982635768539154, 189.53880561764117], [51.74726663344763, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 50.623803564664954, 90, 258.332206048757, 148.58175466933884], [52.004359792233274, 90, 194.4975698920072, 44.36150470187997, 90, 347.31035907115137, 95.56981088493696], [52.04006385047204, 90, 294.44516267386354, 41.55417322262388, 90, 227.43391204709008, 183.90409127690782], [51.54375895065756, 90, 2.184307230365947, 51.48778338609745, 90, 3.9982635768539154, 148.58175466933884], [52.004359792233274, 90, 17.809632929070716, 49.315569125002696, 90, 227.43391204709008, 189.53880561764117], [51.54375895065756, 90, 294.44516267386354, 49.315569125002696, 90, 347.31035907115137, 189.53880561764117], [51.54375895065756, 90, 17.809632929070716, 49.315569125002696, 90, 227.43391204709008, 148.58175466933884], [50.51800344674469, 90, 194.4975698920072, 44.89613657282584, 90, 347.31035907115137, 189.53880561764117], [43.16383779843137, 90, 59.09673586497625, 51.16325026124113, 90, 96.03518767730391, 174.49171904598907], [52.004359792233274, 90, 17.809632929070716, 48.871703222824806, 90, 301.8164954259951, 216.4534141142473], [43.16383779843137, 90, 2.184307230365947, 40.44241342648366, 90, 347.31035907115137, 210.36453368432618], [50.51800344674469, 90, 17.809632929070716, 44.900643535270675, 90, 251.1972914113363, 194.1537065099924], [52.004359792233274, 90, 207.06116785155479, 39.33943622463865, 90, 322.7099304072282, 179.71578576548197], [47.83822743384326, 90, 59.09673586497625, 47.36292688596339, 90, 110.62505164266636, 199.0456020418583], [51.68949795508055, 90, 2.184307230365947, 51.16325026124113, 90, 96.03518767730391, 189.53880561764117], [50.769633076686034, 90, 277.11632983416433, 45.944864344406184, 90, 110.62505164266636, 81.8173308104206], [42.29558510098571, 90, 49.173812578275786, 45.199322183916784, 90, 8.63496392244571, 178.10709001500345], [47.10793712458702, 90, 323.5110467413477, 46.83804806717902, 90, 317.4261298105409, 189.53880561764117], [43.16383779843137, 90, 184.16159102114605, 43.53862133199943, 90, 131.19312946710414, 189.53880561764117], [52.004359792233274, 90, 17.809632929070716, 48.5724849114406, 90, 301.8164954259951, 306.14781952483617], [47.10793712458702, 90, 17.809632929070716, 51.16325026124113, 90, 140.72934241262493, 276.2150073249962], [51.26503502297843, 90, 239.40004746654898, 48.5724849114406, 90, 131.19312946710414, 277.6436564624278], [52.004359792233274, 90, 17.809632929070716, 48.86674930304957, 90, 208.52687437379112, 104.82678825105292], [52.004359792233274, 90, 59.09673586497625, 46.56231715061847, 90, 238.8649847669475, 189.53880561764117], [52.004359792233274, 90, 59.09673586497625, 50.14141287122858, 90, 264.4668029114462, 83.03123112738027], [47.83822743384326, 90, 277.11632983416433, 51.16325026124113, 90, 7.270692107687826, 129.6457157727014], [51.655383417669334, 90, 256.6241398429291, 42.40992096385008, 90, 110.62505164266636, 157.9138877721893], [51.655383417669334, 90, 277.11632983416433, 45.16603983702334, 90, 317.4261298105409, 210.36453368432618], [47.10793712458702, 90, 277.11632983416433, 44.69557041931423, 90, 96.03518767730391, 174.49171904598907], [52.004359792233274, 90, 17.809632929070716, 48.5724849114406, 90, 301.8164954259951, 306.14781952483617], [52.004359792233274, 90, 17.809632929070716, 48.871703222824806, 90, 347.31035907115137, 189.53880561764117], [51.68949795508055, 90, 207.06116785155479, 44.14092340969059, 90, 347.31035907115137, 148.58175466933884], [51.72874261354272, 90, 178.31499039017882, 48.44427919692167, 90, 317.4261298105409, 210.36453368432618], [52.004359792233274, 90, 277.11632983416433, 51.16325026124113, 90, 110.62505164266636, 178.10709001500345], [51.74726663344763, 90, 239.40004746654898, 40.52284552769744, 90, 96.03518767730391, 257.16956003331774], [50.51800344674469, 90, 2.184307230365947, 44.382211547921806, 90, 198.77650654243985, 129.4656407104516], [52.004359792233274, 90, 160.33951292208033, 45.65131043084898, 90, 131.19312946710414, 14.157530606790484], [51.74726663344763, 90, 294.44516267386354, 48.86674930304957, 90, 131.19312946710414, 149.41468925894623], [43.16383779843137, 90, 2.184307230365947, 51.16325026124113, 90, 251.1972914113363, 216.4534141142473], [51.655383417669334, 90, 207.06116785155479, 50.06497042791354, 90, 317.4261298105409, 146.03146260908062], [47.10793712458702, 90, 323.5110467413477, 43.03755252064701, 90, 322.7099304072282, 210.36453368432618], [50.51800344674469, 90, 201.7059023602073, 51.16325026124113, 90, 258.332206048757, 179.71578576548197], [50.769633076686034, 90, 194.4975698920072, 51.64571698141534, 90, 96.03518767730391, 323.1230905404831], [46.110668261251696, 90, 24.904064150366942, 46.65356364138034, 90, 96.03518767730391, 292.250976205701], [51.78608070553043, 90, 273.62722827419014, 40.592980937299345, 90, 110.62505164266636, 219.28752426229048], [52.004359792233274, 90, 256.6241398429291, 39.44589413750743, 90, 253.24635012026997, 151.86240231829092], [50.769633076686034, 90, 49.173812578275786, 50.012321636009716, 90, 7.270692107687826, 189.53880561764117], [49.889055712118335, 90, 239.40004746654898, 49.34886557596016, 90, 317.4261298105409, 189.53880561764117], [42.29558510098571, 90, 277.11632983416433, 50.99348064935067, 90, 8.63496392244571, 178.10709001500345], [51.54375895065756, 90, 286.7708670864571, 48.871703222824806, 90, 258.332206048757, 179.71578576548197], [42.29558510098571, 90, 17.809632929070716, 48.7951991363241, 90, 322.7099304072282, 146.03146260908062], [51.54375895065756, 90, 17.809632929070716, 50.922747501052555, 90, 251.1972914113363, 151.86240231829092], [51.74726663344763, 90, 239.40004746654898, 44.57997676947993, 90, 258.332206048757, 133.34341212157588], [47.83822743384326, 90, 2.184307230365947, 51.16325026124113, 90, 110.62505164266636, 157.9138877721893], [43.16383779843137, 90, 277.11632983416433, 48.353450317606026, 90, 339.3041705956085, 157.9138877721893], [51.74726663344763, 90, 2.184307230365947, 39.71789096826765, 90, 264.4668029114462, 178.10709001500345], [51.26503502297843, 90, 201.7059023602073, 48.50026596293891, 90, 347.31035907115137, 162.08222610452592], [51.78608070553043, 90, 262.92557148914875, 40.44241342648366, 90, 301.8164954259951, 183.90409127690782], [51.26503502297843, 90, 239.40004746654898, 50.10333280096795, 90, 227.43391204709008, 174.49171904598907], [49.889055712118335, 90, 239.40004746654898, 49.34886557596016, 90, 317.4261298105409, 189.53880561764117], [51.26503502297843, 90, 178.31499039017882, 41.58406123327792, 90, 322.7099304072282, 189.53880561764117], [51.78608070553043, 90, 178.31499039017882, 51.16325026124113, 90, 253.24635012026997, 178.10709001500345], [52.004359792233274, 90, 241.44986572925654, 51.16325026124113, 90, 339.3041705956085, 25.695130560170544], [51.26503502297843, 90, 178.31499039017882, 43.68124304437765, 90, 3.9982635768539154, 189.53880561764117], [51.54375895065756, 90, 59.09673586497625, 46.56231715061847, 90, 347.31035907115137, 159.70060580500873], [51.74726663344763, 90, 327.17353915591923, 47.02019110700798, 90, 264.4668029114462, 175.2611747415753], [52.004359792233274, 90, 120.33108308296265, 48.50026596293891, 90, 347.31035907115137, 10.828104993873788], [51.54375895065756, 90, 239.40004746654898, 50.922747501052555, 90, 251.1972914113363, 151.86240231829092], [43.16383779843137, 90, 277.11632983416433, 47.516639872887396, 90, 8.63496392244571, 189.53880561764117], [52.004359792233274, 90, 49.173812578275786, 51.16325026124113, 90, 317.4261298105409, 178.10709001500345], [50.51800344674469, 90, 216.07833240167224, 45.063045824345075, 90, 347.31035907115137, 189.53880561764117], [47.10793712458702, 90, 277.11632983416433, 44.69557041931423, 90, 3.9982635768539154, 162.08222610452592], [52.004359792233274, 90, 2.184307230365947, 51.16325026124113, 90, 347.31035907115137, 189.53880561764117]]
    
    scores = [0 for col in range(item_size)]
    scores = cal(group, scores)
    print("==== init scores:", scores)

    print("---------------- finish GA init ----------------")
    return [group, scores]


def choose(group, scores):
    new_group = [[0 for col in range(7)] for row in range(item_size)]
    p_choose = [0 for col in range(item_size)]
    min_scores = min(scores)
    for i in range(item_size):
        scores[i] = scores[i] - min_scores
    sum_score = sum(scores)
    accumulate = 0
    # 轮盘 init
    for i in range(item_size):
        accumulate += scores[i]
        p_choose[i] = accumulate / sum_score

    # 轮盘 do
    for i in range(item_size-2):
        rand_num = random.random()
        for j in range(item_size):
            if rand_num <= p_choose[j]:
                new_group[i][:] = group[j][:]
                break

    # 保留最优解，一个不动，两个参与交叉变异
    best_item = group[scores.index(max(scores))][:]
    new_group[item_size-1][:] = best_item
    new_group[item_size-2][:] = best_item
    return [best_item, new_group]


def cross(group):
    for i in range(int(item_size/2)):
        if random.random()>cross_rate:
            continue
        num_a = i*2
        num_b = i*2+1
        temp_pos1 = random.randint(0, 6)
        temp_pos2 = random.randint(0, 6)
        pos1 = min(temp_pos1, temp_pos2)
        pos2 = max(temp_pos1, temp_pos2)

        temp = group[num_a][pos1:pos2+1]
        group[num_a][pos1:pos2+1] = group[num_b][pos1:pos2+1]
        group[num_b][pos1:pos2+1] = temp
    return group


def variation(group):
    times = int(item_size * variation_rate)
    for i in range(times):
        num = random.randint(0, item_size-1)
        pos = random.randint(0, 6)
        if (pos == 0 | pos == 3):
            group[num][pos] = random.random()*13+39.24
        elif (pos == 1 | pos == 4):
            group[num][pos] = (group[num][pos]+180)%360
        elif (pos == 2 | pos == 5):
            group[num][pos] = random.random()*360
        elif (pos == 6):
            group[num][pos] = random.random()*360

    return group

def main_ga():
    [group, scores] = init()
    best_scores = [0 for col in range(gen+1)]
    ave_scores = [0 for col in range(gen+1)]
    best_items = [[0 for col in range(7)] for row in range(gen+1)]
    best_scores[0] = max(scores)
    ave_scores[0] = np.mean(scores)
    best_items[0][:] = group[scores.index(max(scores))][:]
    print("---------------- begin GA ----------------")
    for i in range(gen):
        print(i, "================================================")
        # 选择
        [best_item, group] = choose(group, scores)
        # 交叉
        group = cross(group)
        # 变异
        group = variation(group)
        # take best
        group[item_size-1][:] = best_item
        # 适应度
        scores = cal(group, scores)
        # record & print
        best_scores[i+1] = max(scores)
        ave_scores[i+1] = np.mean(scores)
        best_items[i+1][:] = group[scores.index(max(scores))][:]
        print(best_scores[i+1])
        print(ave_scores[i+1])
        print(best_items[i+1][:])
        print("================================================\n\n")
        print((best_scores[i+1]-ave_scores[i+1])/best_scores[i+1]*100, "%")
        if (best_scores[i+1]-ave_scores[i+1])/best_scores[i+1]*100 < 5:
            break

    endTime = time.time()
    print("time: ", endTime - startTime)
    return [best_scores, ave_scores, best_items, endTime]
    


[best_scores, ave_scores, best_items, endTime] = main_ga()

# 火焰图
# pr.disable()
# pr.dump_stats("C:\\ProgramData\\Anaconda3\\Lib\\site-packages\\__pycache__\\request.prof")
# pr.dump_stats("request.prof")
# s = io.StringIO()
# sortby = "cumtime"  # 仅适用于 3.6, 3.7 把这里改成常量了
# ps = pstats.Stats(pr, stream=s).sort_stats(sortby)
# ps.print_stats()
# print(s.getvalue())


# plot
fig1 = plt.figure(1)
plt.plot(best_scores)
plt.xlabel('gen')
plt.ylabel('best_score')
plt.title('best_score of GA')
fig1.savefig('ga2s2c_best_back.png')

fig2 = plt.figure(2)
plt.plot(ave_scores)
plt.xlabel('gen')
plt.ylabel('average_score')
plt.title('average_score of GA')
fig2.savefig('ga2s2c_average_back.png')

print("================================")
print("best: ", best_scores)
print("ave: ", ave_scores)
print("items: ", best_items)
plt.show()

txtStr = "ga2s2c_back.txt"
myFo = open(txtStr, "w")

myFo.write("time_cost\n")
myFo.write(str(endTime - startTime))
myFo.write("\n")
myFo.write("best_score\n")
myFo.write(str(best_scores))
myFo.write("\n")
myFo.write("ave_score\n")
myFo.write(str(ave_scores))
myFo.write("\n")
myFo.write("best_items\n")
myFo.write(str(best_items))

myFo.close()

# 火焰图执行步骤
# python -m cProfile -s cumtime ga.py
# cd C:\ProgramData\Anaconda3\Lib\site-packages\__pycache__
# python flameprof.cpython-37.pyc request.prof > c:\stk\requests.svg